---
title: 5.类的基本概念
date: 2022-07-25 23:56:39.0
updated: 2023-04-18 15:48:52
url: /archives/5-lei-de-ji-ben-gai-nian
categories: 
- C#/.NET
tags: 
- c#
---

## 类的概述

### 类是一种活动的数据结构

程序的数据和功能被组织为逻辑上相关的数据项和函数的封装集合，并成为类。

类是一个能存储数据并执行代码的数据结构。它包含数据成员和函数成员：

> * 数据成员	它存储与类或类的实例相关的数据。
> * 函数成员    代码执行

![image-20220725211627290](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725211627290.png)

## 声明类

类型int、double和char由C#定义。但像Dealer和Player这样的类不是由语言定义，如果使用它们就必须通过**编写类的声明**来定义它们：

> * 类的名称；
> * 类的成员；
> * 类的特征。

实例：

~~~c#
关键字	类名
{
    成员声明
}
class MyExcellentClss
{
    ...
}
~~~

## 类成员

字段和方式是最重要的类成员类型。字段是数据成员，方法是函数成员。

C#在类型的外部**不能声明全局变量**（也就是变量或字段）。所有的字段都属于类型，而且必须在类型声明内部声明。

### 字段

字段是隶属于类的变量：

> * 它可以是任意类型，无论是预定义类型还是用户定义类型。
> * 和所有变量一样，字段用来保存数据，并具有如下特征：
>   * 可以被写入；
>   * 可以被读取。

实例：

~~~c#
类型	字段名称;
Type  Identifier;
//例如，下面的类包含字段MyField的声明，它可以保存int值：
class MyClass
{
    int MyField;//类型  字段名称
}

~~~

1. 显式和隐式字段初始化

   因为字段是一种变量所以和变量初始化语句相同：

   > * **字段初始化语句**是字段声明的一部分，由一个等号后面跟着一个求值表达式构成。
   >
   > * 初始化值必须是编译时可确定的：
   >
   >   ~~~c#
   >   class MyClass
   >   {
   >       int F1 = 17;//类型  字段名称  字段初始化值
   >   }
   >   ~~~
   >
   > * 如果没有初始化语句，字段的值会被编译器设为默认值，默认值由字段的类型决定。如int初始化值为0，bool为false，string为null。

2. 声明多个字段

   方法与前一章相同，实例：

   ~~~c#
   int F1,F3 = 25;
   string F2,F4 = "abcd";
   ~~~

### 方法

方法是具有名称的可执行代码块，可以从程序的很多不同地方执行，甚至从其他程序执行。

当方法被**调用**（call/invoke）时，它执行自己所含的代码，然后返回到调用它的代码并继续执行调用代码。有些方法返回一个值到它们被调用的位置。方法相当于C++中的**成员函数**。

C#**没有全局函数**（方法）声明在类型声明的外部。C#方法没有默认的返回类型，所有方法必须包含返回类型或void

声明方法最简语法包括以下组成部分。

> * 返回类型	方法返回值的类型，如果方法不返回值，那么返回类型被指定void
> * 名称	方法的名称
> * 参数列表	至少有一对空的圆括号组成
> * 方法体	由一对大括号组成，大括号包含执行的代码

例如：

```c#
class SimpleClass
{
    //返回类型	方法名称  参数列表
    void PrintNums()
    {
        Console.WriteLine("1");
        Console.WriteLine("2");
    }
}
```

## 创建变量和类的实例

一旦类被声明，就可以创建类的实例：

> * 类是引用类型
> * 数据的引用保存在一个类类型的变量中

![image-20220725220705021](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725220705021.png)

## 为数据分配内存

声明类类型的变量所分配的内存是用来保存引用的，而不是用来保存类对象实际数据的。需要使用new运算符为实际数据分配内存：

> * new运算符为任意指定类型的实例分配并初始化内存。他依据类型的不同从栈或堆里分配。
>
> * 使用new运算符组成一个**对象创建表达式**，他的组成如下：
>
>   * 关键字 new；
>
>   * 需要分配的内存实例的类型名称；
>
>   * 成对的圆括号，可以是空值
>
>     ![image-20220725221305453](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725221305453.png)
>
> * 如果将内存分配一个引用类型（变量），则对象创建表达式返回一个引用，指向在堆中被分配并初始化的对象实例。

实例：

~~~C#
Dealer theDealer;	//声明引用对象
theDealer = new Dealer();	//为类对象分配内存并赋值给变量
//合并
Dealer theDealer = new Dealer();	//声明并初始化
~~~

![image-20220725223853260](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725223853260.png)

## 实例成员

类声明相当于蓝图，通过这个蓝图创建多少个类的实例都可以。

> * 实例成员	类的每个实例都是不同的实体，它们有自己的一组数据成员，因为这些数据成员都和类的实例相关，所以被称为**实例成员**。
> * 静态成员	实例成员是默认类型，但也可以声明与类而不是实例相关的成员，称为静态成员。

实例：

~~~c#
class Dealer { ... }	//声明类
class Player			//声明类
{
    string Name;		//字段
    ...
}
class Program
{
    static void Main()
    {
        Dealer theDealer = new Dealer();
        Player player1 = new Player();
        Player player2 = new Player();
        Player player3 = new Player();
        ...
    }
}
~~~

![image-20220725230028473](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725230028473.png)

##  访问修饰符

从类的内部，任何函数成员都可以使用成员的名称访问类中任意的其他成员。

访问修饰符成员声明的可选部分。下面是字段和方法声明的语法：

~~~c#
字段
    访问修饰符 类型 标识符;
方法
    访问修饰符 返回类型 方法名()
{
    ...
}
~~~

5种成员访问控制如下：

> * 私有的（private）
> * 公有的（public）
> * 受保护的（protected）
> * 内部的（internal）
> * 受保护内部的（protected internal）

### 私有访问和公有访问

私有成员只能从声明它的类的内部访问，其他的类看不见或者无法访问它们。

> * 私有访问是默认访问级别
>
> * 可以将private访问修饰符显式地将一个成员声明为私有。例如：
>
>   ~~~c#
>   	   int MyInt1;		//隐式声明为私有
>   private int MyInt2;		//显式声明为私有
>   ~~~

1. 公有访问和私有访问图示

   ![image-20220725231724122](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725231724122.png)

2. 成员访问示例

   ~~~c#
   class C1
   {
       int   F1;				//隐式私有字段
       private int F2;			//显式私有字段
       public int F3;			//公有字段
       
       void DoCalc()			//隐式私有方法
       {
           ...
       }
       public int GetVal()		//公有方法
       {
           ...
       }
   }
   ~~~
   ![image-20220725232134734](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725232134734.png)

## 从类的内部访问成员

即使字段和两个方法被声明为private，类的所有成员还是可以被类的任何方法（或任何函数成员）访问。

~~~c#
class DaysTemp
{
    //字段
    private int High = 75;
    private int Low = 45;
    
    //方法
    private int GetHigh()
    {
        return High;		//访问私有字段
    }
    private int GetLow()
    {
        return Low;
    }
    public float Average()
    {
        returm(GetHigh() + GetLow()) /2;   //访问自由方法
    }
}
~~~

## 从类的外部访问成员

要从类的外部访问实例成员，必须包括变量名称和成员名称，中间用句点（.）分隔。这称为**点运算符**（dot-syntax notation）。实例：

~~~c#
DaysTemp myDt = new DaysTemp();		//创建类的对象
float fValue = myDt.Average();		//从外部访问,myDt变量名称，Average成员名称

class DaysTemp		//声明类DaysTemp
{
    public int High = 75;
    public int Low = 45;
}

class Program		//声明类Program
{
    static void Main()
    {
        DaysTemp temp = new DaysTemp();		//创建对象
        temp.High = 85;			//tmp.high字段名称和字段，字段赋值
        temp.Low = 60;
        
        Console.WriteLine("High {0}",temp.High);		//读取字段值
        Console.WriteLine($"Low: {temp.Low}");
    }
}
~~~

## 综合应用

~~~C#
class DaysTemp	//声明类
{
    public int High, Low;	//声明实例字段
    public int Average()
    {
        returm (High + Low) / 2;
    }
    
    class Program
    {
        static void Main()
        {
            //创建两个DaysTemp实例
            DaysTemp t1 = new DaysTemp();
            DaysTemp t2 = new DaysTemp();
            
          	//给字段赋值
            t1.High = 76;	t1.Low = 57;
            t2.High = 75;	t2.Low = 53;
            
            //读取字段值
            //调用实例方法
            Console.WriteLine("t1: {0} {1} {2}", t1.High, t1.Low, t1.Average() );
            console.WriteLine("t2: {0} {1} {2}", t2.High, t2.Low, t2.Average() );
        }
    }
}
~~~

![image-20220725235419052](https://cdn.jsdelivr.net/gh/WRXinYue/PictureCDN/img/image-20220725235419052.png)